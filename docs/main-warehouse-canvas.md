# MainWarehouseCanvas - Интерактивная схема главного склада

## Описание
Компонент `MainWarehouseCanvas` предоставляет интерактивную визуальную схему для склада "EXTRA SPACE Главный склад". Компонент использует библиотеку `react-konva` для отрисовки интерактивной карты с возможностью выбора боксов.

## Используемые файлы
- **Схема**: `src/assets/Main_Individual_storage.json`
- **Фоновое изображение**: `src/assets/Main_Individual.png`
- **Иконка замка**: `src/assets/lock.png`

## Размеры Canvas
- Ширина: 1280px
- Высота: 751px

## Цветовая схема
- **Свободный бокс**: `#fef3b2` (жёлтый)
- **Занятый бокс**: `rgba(200, 200, 200, 0.8)` (серый) + иконка замка
- **Выбранный бокс**: `rgba(39, 54, 85, 0.7)` (темно-синий)
- **Hover эффект**: `rgba(254, 243, 178, 0.9)` (яркий жёлтый)

## Особенности схемы
Схема главного склада содержит разные типы форм боксов:
1. **Прямоугольные боксы** - стандартные формы с параметрами `x`, `y`, `width`, `height`
2. **Произвольные формы** - L-образные и полигональные боксы с параметром `points`

## Props компонента
```javascript
{
  storageBoxes: Array,     // Массив данных о боксах с API
  onBoxSelect: Function,   // Функция обратного вызова при выборе бокса
  selectedStorage: Object  // Текущий выбранный бокс
}
```

## Логика работы
1. При загрузке компонента происходит загрузка фонового изображения и иконки замка
2. Для каждого бокса из JSON схемы проверяется его статус в массиве `storageBoxes`
3. **Сопоставление происходит по имени без учета регистра** (для совместимости с API)
4. В зависимости от статуса (`VACANT`/`OCCUPIED`) применяется соответствующая цветовая схема
5. При клике на свободный бокс вызывается функция `onBoxSelect`
6. Отображается информационная панель с данными выбранного бокса
7. Показывается легенда с объяснением цветов
8. Добавлена отладочная информация для диагностики проблем сопоставления

## Интеграция
Компонент интегрирован в `WarehouseOrderPage` и отображается при выборе склада "EXTRA SPACE Главный склад":

```javascript
import MainWarehouseCanvas from '../../components/MainWarehouseCanvas';

// В условии рендеринга:
{selectedWarehouse.name === "EXTRA SPACE Главный склад" ? (
  <div className="flex justify-center">
    <MainWarehouseCanvas
      storageBoxes={selectedWarehouse.storage}
      onBoxSelect={setSelectedStorage}
      selectedStorage={selectedStorage}
    />
  </div>
) : null}
```

## Обработка форм боксов
Компонент корректно обрабатывает два типа геометрии:
- **Прямоугольники**: используется компонент `Rect` из react-konva
- **Произвольные формы**: используется компонент `Line` с параметрами `points` и `closed={true}`

## Accessibility
- Hover эффекты для интерактивных элементов
- Визуальная индикация выбранного элемента
- Информационная панель с подробными данными
- Легенда для понимания цветовой схемы

## Устранение неполадок

### Проблема: Все боксы отображаются как занятые (OCCUPIED)
**Причина**: Несоответствие имен боксов в JSON схеме и данных API.

**Решение**: 
1. Проверьте консоль браузера на наличие отладочной информации
2. Убедитесь, что имена боксов в API соответствуют именам в `Main_Individual_storage.json`
3. Функция сопоставления работает без учета регистра (например, "1A" и "1a" считаются одинаковыми)

### Отладочная информация
В режиме разработки компонент выводит в консоль:
- Данные боксов, полученные с API
- Список имен боксов типа INDIVIDUAL
- Информацию о боксах, которые не найдены в API данных

### Проверка работы
1. Откройте страницу заказа бокса
2. Выберите склад "EXTRA SPACE Главный склад"
3. Откройте консоль браузера (F12)
4. Посмотрите на отладочную информацию о боксах 